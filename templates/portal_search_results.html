{%- extends 'base.html' %}

{% block styles %}
{{super()}}
<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/jquery.dataTables.min.css')}}">
{% endblock %}

{% block scripts %}
{{super()}}
<script type="text/javascript">
var typeahead_genes = [
{% for gene in typeahead_genes %}
'{{gene}}',
{% endfor %}
];
</script>
<script src="{{url_for('static', filename='js/typeahead.bundle.js')}}"></script>
<script src="{{url_for('static', filename='js/portal.js')}}"></script>
<script src="{{url_for('static', filename='js/jquery.dataTables.min.js')}}"></script>
{% endblock %}

{% block page_content %}
<h1>TARGET DB Search Results</h1>

<div id="browse-search-row" class="row">
    <div class="col-md-5">
        <form action="search" method="get">
            <div class="input-group">
                <input id="gene-input" type="text" name="g" class="form-control typeahead" placeholder="Gene name">
                <span class="input-group-btn">
                        <button type="submit" class="btn btn-default btn-search" type="button">Search</button>
                    </span>
            </div>
        </form>
    </div>
</div>

<p class="text-muted">Click on any alteration below to view more details about the alteration-actionability relationship.</p>

<table class="results-table display compact">
    <thead>
    <tr><th>Gene</th><th>Feature</th><th>Alt. type</th><th>Alteration</th><th>Therapy</th><th>Response</th><th>Cancer type</th><th>Predictive Level</tr>
    </thead>
    <tbody>
    {% for row in rows %}
    <tr>
        <td>{% if row['gene_name'] %}<a href="search?g={{row['gene_name']}}">{{row['gene_name']}}</a>{% endif %}</td>
        <td>{{row['feature'] if row['feature'] is not none}}</td>
        <td>{{row['alt_type'] if row['alt_type'] is not none}}</td>
        <td><a href="assertion/{{row['assertion_id']}}">{{row['alt'] if row['alt'] is not none else '(any)'}}</a></td>
        <td>{% if row['therapy_name'] %}<a href="search?t={{row['therapy_name']}}">{{row['therapy_name']}}</a>{% endif %}</td>
        <td>{% if row['therapy_sensitivity'] is not none %}
            {% if row['therapy_sensitivity'] %}Sensitivity{% else %}Resistance{% endif %}{% endif %}</td>
        <td>{% if row['disease'] %}<a href="search?d={{row['disease']}}">{{row['disease']}}{% endif %}</td>
        <td data-order="{{pred_impl_orders[row['predictive_implication']]}}">{{row['predictive_implication'] if row['predictive_implication'] is not none}}</td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{%- endblock %}
